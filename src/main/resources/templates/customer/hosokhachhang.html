<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<!--thư viện-->
<nav th:replace="~{/layout/head.html}"></nav>
<!--end-->
<style>
    .thongtintaikhoan p {
        font-size: 16px;
        line-height: 25px;
        margin: 10px 0 5px;
        font-weight: 550;
    }

    th {
        white-space: nowrap;
    }

    td {
        white-space: nowrap;
    }

    /*.thongtindiachi p {*/
    /*    font-size: 16px;*/
    /*    line-height: 25px;*/
    /*    margin: 10px 0 5px;*/
    /*    font-weight: 550;*/
    /*}*/
</style>
<body style="font-family: 'futura-REGULAR', sans-serif;">

<!-- header section start -->
<nav th:replace="~{/layout/header.html}"></nav>
<!-- header section end -->

<!-- page banner area start -->
<!--<nav th:replace="~{/layout/banner.html}"></nav>-->
<!-- page banner area end -->

<!-- cart page content section start -->

<section class="content" style="margin-top: 50px;">
    <!--    <h6 style="margin-left: 20px"><a th:href="@{/customer/trangchu}">Trang chủ </a>/ Tài khoản của tôi</h6>-->
    <!-- /.container-fluid -->
    <div class="container">
        <div class="row">
            <div class="col-lg-3 border rounded" style="background-color: #EEEEEE; height: 450px; width: 300px">
                <div class="d-flex justify-content-center mt-5 mb-3">
                    <img id="uploadedImage" th:src="${userAvatar}" class="rounded-circle" width="120" height="120" style="cursor: pointer;">
                </div>
                <div class="file-input-wrapper">
                    <input type="file" id="fileInput" class="file-input" name="anh" accept="image/*" style="display:none;">
                </div>
                <p class="d-flex justify-content-center mb-4" style="font-size: 18px;">Xin chào <span
                        style="color: #0a58ca; padding-left: 7px;" th:text="${hovatenHoSo}">Nguyễn Văn Duy</span>
                </p>
                <div class="card-body" style="height: 407px">
                    <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist"
                         aria-orientation="vertical">
                        <button style="padding-left: 60px;" class="nav-link active text-start d-flex align-items-center"
                                id="v-pills-home-tab" data-bs-toggle="pill"
                                data-bs-target="#v-pills-home" type="button" role="tab" aria-controls="v-pills-home"
                                aria-selected="true">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                 class="bi bi-card-heading" viewBox="0 0 16 16">
                                <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z"/>
                                <path d="M3 8.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5m0-5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5z"/>
                            </svg>
                            <span style="margin-left: 7px;">Thông tin tài khoản</span>
                        </button>
                        <button style="padding-left: 60px;" class="nav-link text-start d-flex align-items-center"
                                id="v-pills-profile-tab" data-bs-toggle="pill"
                                data-bs-target="#v-pills-profile" type="button" role="tab"
                                aria-controls="v-pills-profile" aria-selected="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                 class="bi bi-house-add" viewBox="0 0 16 16">
                                <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h4a.5.5 0 1 0 0-1h-4a.5.5 0 0 1-.5-.5V7.207l5-5 6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293z"/>
                                <path d="M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0m-3.5-2a.5.5 0 0 0-.5.5v1h-1a.5.5 0 0 0 0 1h1v1a.5.5 0 1 0 1 0v-1h1a.5.5 0 1 0 0-1h-1v-1a.5.5 0 0 0-.5-.5"/>
                            </svg>
                            <span style="margin-left: 7px;">Danh sách địa chỉ</span>

                        </button>
                        <button style="padding-left: 60px;" class="nav-link text-start d-flex align-items-center"
                                id="v-pills-disabled-tab" data-bs-toggle="pill"
                                data-bs-target="#v-pills-disabled" type="button" role="tab"
                                aria-controls="v-pills-disabled" aria-selected="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                 class="bi bi-key" viewBox="0 0 16 16">
                                <path d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"/>
                                <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
                            </svg>
                            <span style="margin-left: 7px;">Đổi mật khẩu</span>
                        </button>
                        <button style="padding-left: 60px;" class="nav-link text-start d-flex align-items-center"
                                id="v-pills-messages-tab" data-bs-toggle="pill"
                                data-bs-target="#v-pills-messages" type="button" role="tab"
                                aria-controls="v-pills-messages" aria-selected="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                 class="bi bi-border-style" viewBox="0 0 16 16">
                                <path d="M1 3.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5zm0 4a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5zm0 4a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm8 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-4 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm8 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-4-4a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5z"/>
                            </svg>
                            <span style="margin-left: 7px;">Đơn hàng của tôi</span>
                        </button>
                    </div>
                </div>
                <!-- /.card -->
            </div>
            <!-- /.col -->
            <div class="col-lg-9">
                <div class=" card border-light" style="width: 100%;height: 100%">
                    <div class="card-body">
                        <div class="tab-content" id="v-pills-tabContent">

                            <!--hồ sơ cá nhân-->
                            <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel"
                                 aria-labelledby="v-pills-home-tab" tabindex="0">
                                <div id="xemthongtintaikhoan">
                                    <p style="font-size: 18px; font-weight: 650; padding-top: 7px;">THÔNG TIN TÀI
                                        KHOẢN</p>
                                    <hr class="border border-danger border opacity-50">
                                    <div class="row">
                                        <div class="thongtintaikhoan col-lg-10">
                                            <p>
                                                <span style="color: #808080;min-width: 115px;display: inline-block;">Họ và tên: </span>
                                                <span th:text="${nguoidung.hovaten}"></span>
                                            </p>
                                            <p>
                                                <span style="color: #808080;min-width: 115px;display: inline-block;">Giới tính: </span>
                                                <span th:text="${nguoidung.gioitinh == true ? 'Nam' : ''}"></span>
                                                <span th:text="${nguoidung.gioitinh == false ? 'Nữ' : ''}"></span>
                                                <span th:text="${nguoidung.gioitinh == null ? 'Chưa có giới tính' : ''}"></span>
                                            </p>
                                            <p>
                                                <span style="color: #808080;min-width: 115px;display: inline-block;">Email: </span>
                                                <span th:text="${nguoidung.email}"></span>
                                            </p>
                                            <p>
                                                <span style="color: #808080;min-width: 115px;display: inline-block;">Địa chỉ: </span>
                                                <span th:if="${#strings.isEmpty(diachi.tenduong) and #strings.isEmpty(diachi.xaphuong) and #strings.isEmpty(diachi.quanhuyen) and #strings.isEmpty(diachi.tinhthanhpho)}"
                                                      th:text="'Chưa có địa chỉ'"></span>
                                                <span th:unless="${#strings.isEmpty(diachi.tenduong) and #strings.isEmpty(diachi.xaphuong) and #strings.isEmpty(diachi.quanhuyen) and #strings.isEmpty(diachi.tinhthanhpho)}"
                                                      th:text="${diachi.tenduong + ', ' + diachi.xaphuong + ', ' + diachi.quanhuyen + ', ' + diachi.tinhthanhpho}"></span>
                                            </p>
                                            <p>
                                                <span style="color: #808080;min-width: 115px;display: inline-block;">Ngày sinh: </span>
                                                <span th:text="${#dates.format(nguoidung.ngaysinh, 'dd/MM/yyyy')}"></span>
                                            </p>
                                            <p>
                                                <span style="color: #808080;min-width: 115px;display: inline-block;">Điện thoại: </span>
                                                <span th:text="${nguoidung.sodienthoai}"></span>
                                            </p>
                                            <p>
                                                <span style="color: #808080;min-width: 115px;display: inline-block;">CCCD: </span>
                                                <span th:if="${#strings.isEmpty(nguoidung.cccd)}"
                                                      th:text="'Chưa có căn cước công dân'"></span>
                                                <span th:unless="${#strings.isEmpty(nguoidung.cccd)}"
                                                      th:text="${nguoidung.cccd}"></span>
                                            </p>
                                        </div>
                                        <div class="col-lg-2 mt-2" style="right: 0">
                                            <button id="btnchuyencapnhattaikhoan"
                                                    style="background-color: rgb(249,72,42);color: white; padding: 5px 10px; width: 100px; height: 50px; border-radius: 10px; border-color: rgb(249,72,42);">
                                                Cập nhật
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!--cap nhat thong tin tai khoan-->
                                <div id="capnhatthongtintaikhoan">
                                    <p style="font-size: 18px; font-weight: 650; padding-top: 7px;">CẬP NHẬT THÔNG TIN
                                        TÀI KHOẢN</p>
                                    <hr class="border border-danger border opacity-50">
                                    <div style="width: 70%;" class="d-flex justify-content-center container">
                                        <form th:object="${nguoidung}" th:method="post" name="updateThongTinNguoiDung"
                                              th:action="@{/capnhattaikhoan/{username}(username=${userDangnhap})}"
                                              onsubmit="return validateNguoiDung()"
                                              style="width: 100%">
                                            <div class="form-floating mb-3">
                                                <input type="text" class="form-control" th:field="*{hovaten}"
                                                       maxlength="50"
                                                       id="hovaten"
                                                       placeholder="Họ và tên">
                                                <label>Họ và tên</label>
                                                <span id="hovatenNdError" style="color: red"></span>
                                            </div>
                                            <div class="form-floating mb-3">
                                                <select class="form-select" th:field="*{gioitinh}"
                                                        aria-label="Floating label select example"
                                                        style="width: 100px">
                                                    <option value="1" selected>Nam</option>
                                                    <option value="0">Nữ</option>
                                                </select>
                                                <label>Giới tính</label>
                                            </div>
                                            <div class="form-floating mb-3">
                                                <input type="text" class="form-control" th:field="*{cccd}"
                                                       placeholder="Căn cước công dân">
                                                <label>Căn cước công dân</label>
                                                <span id="cccdError" style="color: red"></span>
                                            </div>
                                            <div class="form-floating mb-3">
                                                <input type="text" class="form-control" th:field="*{email}" id="email"

                                                       placeholder="name@example.com">
                                                <label>Email</label>
                                                <span id="emailNdError" style="color: red"></span>
                                            </div>
                                            <div class="form-floating mb-3">
                                                <input type="text" class="form-control" th:field="*{sodienthoai}"
                                                       id="sodienthoai"

                                                       placeholder="Số điện thoại">
                                                <label>Số điện thoại</label>
                                                <span id="sdtNdError" style="color: red"></span>
                                            </div>
                                            <div class="form-floating mb-3">
                                                <input type="date" class="form-control" th:field="*{ngaysinh}"
                                                       id="ngaysinh" onkeydown="return false"
                                                       placeholder="Ngày sinh">
                                                <label>Ngày sinh</label>
                                                <span id="ngaysinhNdError" style="color: red"></span>
                                            </div>
                                            <div class="d-flex justify-content-center align-items-center mb-4">
                                                <a id="huycapnhattaikhoan" href="#"
                                                   style="color: #808080; text-decoration: none; text-transform: none; margin-right: 50px; font-weight: 550; ">Hủy</a>
                                                <button id="btncapnhattaikhoan"
                                                        style="background-color: rgb(249,72,42);color: white; padding: 5px 10px; width: 100px; height: 50px; border-radius: 10px;">
                                                    Cập nhật
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <!--end-->

                            <!--địa chỉ của tôi-->
                            <div class="tab-pane fade" id="v-pills-profile" role="tabpanel"
                                 aria-labelledby="v-pills-profile-tab" tabindex="0">
                                <div id="xemthongtindiachi">
                                    <p style="font-size: 18px; font-weight: 650; padding-top: 7px;">THÔNG TIN ĐỊA CHỈ
                                    </p>
                                    <hr class="border border-danger border opacity-50">

                                    <!-- Address Section -->
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <!--                                        <h3>Địa chỉ của tôi</h3>-->
                                        <button id="chuyencapnhatdiachi" style="background-color: rgb(249,72,42);color: white; padding: 5px 10px; width: auto; height: 50px; border-radius: 10px;" class="btn btn-danger">+ Thêm địa chỉ
                                            mới
                                        </button>
                                    </div>
                                    <!-- List địa chỉ-->
                                    <div id="thongtindiachi">
                                        <div th:each="lstDiaChi:${lstDiaChi}">
                                            <!--                                            <div class="d-flex justify-content-center align-items-center" th:if="${#strings.isEmpty(lstDiaChi.tenduong)}">-->
                                            <!--                                                <img style="width: 300px"-->
                                            <!--                                                        src="https://img.freepik.com/premium-vector/pirate-map-icon-vector-image-can-be-used-pirate_120816-91695.jpg?w=740" alt="">-->
                                            <!--                                            </div>-->
                                            <!--                                            <div th:unless="${#strings.isEmpty(lstDiaChi.tenduong)}">-->
                                            <div class="address-item mb-3" th:if="${lstDiaChi.trangthai == true}">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <div>
                                                        <strong th:text="${lstDiaChi.hotennguoinhan}">Đỗ Quốc
                                                            Thịnh</strong> <span
                                                            th:text="${lstDiaChi.sdtnguoinhan}">(+84) 866511075</span>
                                                        <p th:if="${#strings.isEmpty(lstDiaChi.tenduong)}"
                                                           th:text="'Chưa có địa chỉ'">ố 24 liên kề 31 khu đô
                                                            thị
                                                            mới vân canh</p>
                                                        <p th:unless="${#strings.isEmpty(lstDiaChi.tenduong)}"
                                                           th:text="${lstDiaChi.tenduong}">ố 24 liên kề 31 khu đô
                                                            thị
                                                            mới vân canh</p>
                                                        <p th:if="${#strings.isEmpty(lstDiaChi.tinhthanhpho)}"
                                                           th:text="'Chưa có địa chỉ'"></p>
                                                        <p th:unless="${#strings.isEmpty(lstDiaChi.tinhthanhpho)}"
                                                           th:text="${lstDiaChi.xaphuong + ', ' + lstDiaChi.quanhuyen + ', ' + lstDiaChi.tinhthanhpho}">
                                                            Xã Vân Canh, Huyện Hoài Đức, Hà Nội</p>
                                                    </div>
                                                    <div>
                                                        <a id="chuyencapnhatdiachi2" style="text-transform: none; text-decoration: none; color: rgb(249,72,42)" href="#" class="btn btn-link">Cập
                                                            nhật</a>
                                                        <button class="btn btn-light btn-sm">Mặc định</button>
                                                    </div>
                                                </div>
                                                <hr>
                                            </div>
                                            <div class="address-item mb-3" th:if="${lstDiaChi.trangthai == false}">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <div>
                                                        <strong th:text="${lstDiaChi.hotennguoinhan}">Đỗ Quốc
                                                            Thịnh</strong> <span
                                                            th:text="${lstDiaChi.sdtnguoinhan}">(+84) 866511075</span>
                                                        <p th:text="${lstDiaChi.tenduong}">Abcd Lương Văn Can TP Nam
                                                            Định</p>
                                                        <p th:text="${lstDiaChi.xaphuong + ', ' + lstDiaChi.quanhuyen + ', ' + lstDiaChi.tinhthanhpho}">
                                                            Phường Hạ Long, Thành Phố Nam Định, Nam Định</p>
                                                    </div>
                                                    <div>
                                                        <a th:href="@{/xoadiachi(id=${lstDiaChi.id})}"
                                                           class="btn btn-link" id="btnXoaDiaChi" style="text-decoration: none; text-transform: none; color: rgb(249,72,42)">Xóa</a>
                                                        <a th:href="@{/thietlapmacdinh(id=${lstDiaChi.id})}" id="macdinh"
                                                           class="btn btn-link btnUpDateTrangThai" style="text-decoration: none; text-transform: none; color: black">Thiết lập mặc
                                                            định</a>
                                                    </div>
                                                </div>
                                                <hr>
                                            </div>
                                            <!--                                            </div>-->
                                        </div>
                                    </div>
                                </div>
                                <!-- Form thêm địa chỉ-->
                                <div id="capnhatdiachi">
                                    <p style="font-size: 18px; font-weight: 650; padding-top: 7px;">THÊM THÔNG TIN
                                        ĐỊA CHỈ</p>
                                    <hr class="border border-danger border opacity-50">
                                    <div id="themdiachi" style="width: 70%;"
                                         class="d-flex justify-content-center container">
                                        <form th:object="${addDiaChi}" th:method="post" id="frmAddDiaChi"
                                              name="frmAddDiaChi"
                                              th:action="@{/themdiachi/{username}(username=${userDangnhap})}"
                                              onsubmit="return validateThemDiaChi()"
                                              style="width: 100%">
                                            <div>
                                                <div class="form-floating mb-3">
                                                    <input type="text" class="form-control" th:field="*{hotennguoinhan}"
                                                           id="hotennguoinhan" maxlength="50"
                                                           placeholder="Họ và tên">
                                                    <label>Họ và tên</label>
                                                    <span id="hotennguoinhanError" style="color: red"></span>
                                                </div>
                                                <div class="form-floating mb-3">
                                                    <input type="text" class="form-control" th:field="*{sdtnguoinhan}"
                                                           id="sdtnguoinhan"
                                                           placeholder="Số điện thoại">
                                                    <label>Số điện thoại</label>
                                                    <span id="sdtnguoinhanError" style="color: red"></span>
                                                </div>
                                            </div>
                                            <div class="form-floating mb-3">
                                                <input type="text" class="form-control" id="tenduong"
                                                       th:field="*{tenduong}" maxlength="100"
                                                       placeholder="Địa chỉ">
                                                <label>Địa chỉ</label>
                                                <span id="tenduongError" style="color: red"></span>
                                            </div>
                                            <div class="d-flex justify-content-between mb-4">
                                                <div class="form-floating">
                                                    <select class="form-select" id="city" th:field="*{tinhthanhpho}"
                                                            aria-label="Floating label select example"
                                                            style="width: 200px">
                                                        <option th:value="*{tinhthanhpho}"
                                                                th:text="*{tinhthanhpho}">Chọn tỉnh/thành phố
                                                        </option>
                                                    </select>
                                                    <label>Tỉnh/thành phố</label>
                                                    <span id="tinhthanhError" style="color: red"></span>
                                                </div>
                                                <div class="form-floating">
                                                    <select class="form-select" id="district"
                                                            th:field="*{quanhuyen}"
                                                            aria-label="Floating label select example"
                                                            style="width: 200px">
                                                        <option th:value="*{quanhuyen}" th:text="*{quanhuyen}"
                                                                selected>Chọn quận huyện
                                                        </option>
                                                    </select>
                                                    <label>Quận/huyện</label>
                                                    <span id="quanhuyenError" style="color: red"></span>
                                                </div>
                                                <div class="form-floating">
                                                    <select class="form-select" id="ward" th:field="*{xaphuong}"
                                                            aria-label="Floating label select example"
                                                            style="width: 200px">
                                                        <option th:value="*{xaphuong}" th:text="*{xaphuong}"
                                                                selected>Chọn phường xã
                                                        </option>
                                                    </select>
                                                    <label>Phường/xã</label>
                                                    <span id="xaphuongError" style="color: red"></span>
                                                </div>
                                            </div>
                                            <div class="d-flex justify-content-center align-items-center mb-4">
                                                <a id="huycapnhatdiachi" href="#"
                                                   style="color: #808080; text-decoration: none; text-transform: none; margin-right: 50px; font-weight: 550; ">Hủy</a>
                                                <button type="submit" id="btnThemDiaChi"
                                                        style="background-color: rgb(249,72,42);color: white; padding: 5px 10px; width: auto; height: 50px; border-radius: 10px; border-color: rgb(249,72,42);">
                                                    Thêm địa chỉ
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <!-- form cập nhật địa chỉ -->
                                <div id="capnhatdiachi2">
                                    <p style="font-size: 18px; font-weight: 650; padding-top: 7px;">CẬP NHẬT THÔNG TIN
                                        ĐỊA CHỈ</p>
                                    <hr class="border border-danger border opacity-50">
                                    <div id="themdiachi2" style="width: 70%;"
                                         class="d-flex justify-content-center container">
                                        <form th:object="${updateDiaChi}" th:method="post" name="frmUpdateDiaChi"
                                              th:action="@{/suadiachi/{username}(username=${userDangnhap})}"
                                              onsubmit="return validateSuaDiaChi()"
                                              style="width: 100%">
                                            <div>
                                                <div class="form-floating mb-3">
                                                    <input type="text" class="form-control" th:field="*{hotennguoinhan}"
                                                           id="hotennguoinhan2" maxlength="50"
                                                           placeholder="Họ và tên">
                                                    <label>Họ và tên</label>
                                                    <span id="hotennguoinhanError2" style="color: red"></span>
                                                </div>
                                                <div class="form-floating mb-3">
                                                    <input type="text" class="form-control" th:field="*{sdtnguoinhan}"
                                                           id="sdtnguoinhan2"
                                                           placeholder="Số điện thoại">
                                                    <label>Số điện thoại</label>
                                                    <span id="sdtnguoinhanError2" style="color: red"></span>
                                                </div>
                                            </div>
                                            <div class="form-floating mb-3">
                                                <input type="text" class="form-control" id="tenduong2"
                                                       th:field="*{tenduong}" maxlength="100"
                                                       placeholder="Địa chỉ">
                                                <label for="tenduong2">Địa chỉ</label>
                                                <span id="tenduongError2" style="color: red"></span>
                                            </div>
                                            <div class="d-flex justify-content-between mb-4">
                                                <div class="form-floating">
                                                    <select class="form-select" id="city2" th:field="*{tinhthanhpho}"
                                                            aria-label="Floating label select example"
                                                            style="width: 200px">
                                                        <option th:value="*{tinhthanhpho}"
                                                                th:text="*{tinhthanhpho}">Chọn tỉnh/thành phố
                                                        </option>
                                                    </select>
                                                    <label>Tỉnh/thành phố</label>
                                                    <span id="tinhthanhError2" style="color: red"></span>
                                                </div>
                                                <div class="form-floating">
                                                    <select class="form-select" id="district2"
                                                            th:field="*{quanhuyen}"
                                                            aria-label="Floating label select example"
                                                            style="width: 200px">
                                                        <option th:value="*{quanhuyen}" th:text="*{quanhuyen}"
                                                                selected>Chọn quận huyện
                                                        </option>
                                                    </select>
                                                    <label>Quận/huyện</label>
                                                    <span id="quanhuyenError2" style="color: red"></span>
                                                </div>
                                                <div class="form-floating">
                                                    <select class="form-select" id="ward2" th:field="*{xaphuong}"
                                                            aria-label="Floating label select example"
                                                            style="width: 200px">
                                                        <option th:value="*{xaphuong}" th:text="*{xaphuong}"
                                                                selected>Chọn phường xã
                                                        </option>
                                                    </select>
                                                    <label>Phường/xã</label>
                                                    <span id="xaphuongError2" style="color: red"></span>
                                                </div>
                                            </div>
                                            <div class="d-flex justify-content-center align-items-center mb-4">
                                                <a id="huycapnhatdiachi2" href="#"
                                                   style="color: #808080; text-decoration: none; text-transform: none; margin-right: 50px; font-weight: 550; ">Hủy</a>
                                                <button type="submit" id="btnCapNhatDiaChi"
                                                        style="background-color: rgb(249,72,42);color: white; padding: 5px 10px; width: auto; height: 50px; border-radius: 10px; border-color: rgb(249,72,42);">
                                                    Cập nhật
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <!-- end form cập nhật địa chỉ-->
                            </div>
                            <!--end -->

                            <!--đổi mật khẩu-->
                            <div class="tab-pane fade" id="v-pills-disabled" role="tabpanel"
                                 aria-labelledby="v-pills-disabled-tab" tabindex="0">
                                <form th:object="${nguoidungdoimatkhau}" th:method="post" onsubmit="return doimatkhau()"
                                      th:action="@{/doimatkhau/{username}(username=${userDangnhap})}">
                                    <p style="font-size: 18px; font-weight: 650; padding-top: 7px;">ĐỔI MẬT KHẨU</p>
                                    <h6 style="color: red;font-style: italic">Để bảo mật tài khoản,
                                        vui lòng
                                        không
                                        chia sẻ mật khẩu cho người khác</h6>
                                    <hr class="border border-danger border opacity-50">
                                    <p><span style="color: red">(*)</span> Mật khẩu hiện tại:
                                        <input type="password" class="form-control" th:field="*{matkhau}">
                                        <span id="maukhaucuError" style="color: red"></span>
                                        <span th:text="${error1}" class="mb-3" style="color: red;"></span>
                                    </p>
                                    <p><span style="color: red">(*)</span> Mật khẩu mới:
                                        <input type="password" class="form-control" th:field="*{matkhaumoi}">
                                        <span id="maukhaumoiError" style="color: red"></span>
                                    </p>
                                    <p><span style="color: red">(*)</span> Xác nhận mật khẩu mới:
                                        <input type="password" class="form-control" name="xacnhanmatkhau"
                                               th:field="*{xacnhanmatkhau}">
                                        <span id="maukhauxnError" style="color: red"></span>
                                        <span th:text="${error2}" class="mb-3" style="color: red;"></span>
                                    </p>
                                    <p>
                                        <button type="submit" class="btn" id="btnDoiMatKhau"
                                                style="background-color: rgb(249,72,42);color: white">
                                            Đổi mật khẩu
                                        </button>
                                    </p>
                                </form>
                            </div>
                            <!--end-->

                            <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" style="width: 113%"
                                 aria-labelledby="v-pills-messages-tab" tabindex="0">
                                <p style="font-size: 18px; font-weight: 650; padding-top: 7px;">ĐƠN HÀNG CỦA TÔI</p>
                                <ul class="nav nav-tabs" id="myTab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="home-tab"
                                                data-bs-toggle="tab"
                                                data-bs-target="#home-tab-pane" type="button"
                                                role="tab"
                                                aria-controls="home-tab-pane" aria-selected="true">
                                            Tất cả
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="profile-tab"
                                                data-bs-toggle="tab"
                                                data-bs-target="#profile-tab-pane" type="button"
                                                role="tab"
                                                aria-controls="profile-tab-pane"
                                                aria-selected="false">Chờ xác nhận
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="contact-tab"
                                                data-bs-toggle="tab"
                                                data-bs-target="#contact-tab-pane" type="button"
                                                role="tab"
                                                aria-controls="contact-tab-pane"
                                                aria-selected="false"> Đã xác nhận
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="disabled-tab1"
                                                data-bs-toggle="tab"
                                                data-bs-target="#disabled-tab-pane1" type="button"
                                                role="tab"
                                                aria-controls="disabled-tab-pane1"
                                                aria-selected="false">Chờ giao hàng
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="disabled-tab2"
                                                data-bs-toggle="tab"
                                                data-bs-target="#disabled-tab-pane2" type="button"
                                                role="tab"
                                                aria-controls="disabled-tab-pane2"
                                                aria-selected="false">Đang giao hàng
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="disabled-tab3"
                                                data-bs-toggle="tab"
                                                data-bs-target="#disabled-tab-pane3" type="button"
                                                role="tab"
                                                aria-controls="disabled-tab-pane3"
                                                aria-selected="false">Đã thanh toán
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="disabled-tab4"
                                                data-bs-toggle="tab"
                                                data-bs-target="#disabled-tab-pane4" type="button"
                                                role="tab"
                                                aria-controls="disabled-tab-pane4"
                                                aria-selected="false">Đã hoàn thành
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="disabled-tab5"
                                                data-bs-toggle="tab"
                                                data-bs-target="#disabled-tab-pane5" type="button"
                                                role="tab"
                                                aria-controls="disabled-tab-pane5"
                                                aria-selected="false">Đã hủy
                                        </button>
                                    </li>
                                </ul>
                                <div class="tab-content" id="myTabContent">
                                    <div class="tab-pane fade show active" id="home-tab-pane"
                                         role="tabpanel"
                                         aria-labelledby="home-tab" tabindex="0">
                                        <table id="example2"
                                               class="table table-bordered table-hover text-center dataTables_wrapper dt-bootstrap4 no-footer">
                                            <thead class="table table-danger">
                                            <tr>
                                                <th>STT</th>
                                                <th>Mã hóa đơn</th>
                                                <th>Tên khách hàng</th>
                                                <th>Số điện thoại</th>
                                                <th>Tổng tiền</th>
                                                <th style="white-space: nowrap;">Ngày giao dự kiến</th>
                                                <th>Trạng thái</th>
                                                <th>Thao tác</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="hd,stt:${lstHoaDon}">
                                                <td th:text="${stt.index+1}"></td>
                                                <td th:text="${hd.mahoadon}"></td>
                                                <td th:text="${hd.khachhang.nguoidung.hovaten}"></td>
                                                <td th:text="${hd.sdt}"></td>
                                                <td th:text="${#numbers.formatDecimal(hd.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></td>
                                                <td th:text="${#dates.format(hd.ngaygiaodukien, 'dd/MM/yyyy')}"></td>
                                                <td th:if="${hd.trangthai == 0}">Chờ xác nhận</td>
                                                <td th:if="${hd.trangthai == 1}">Đã xác nhận</td>
                                                <td th:if="${hd.trangthai == 2}">Chờ giao hàng</td>
                                                <td th:if="${hd.trangthai == 3}">Đang giao hàng</td>
                                                <td th:if="${hd.trangthai == 4}">Đã thanh toán</td>
                                                <td th:if="${hd.trangthai == 5}">Đã hoàn thành</td>
                                                <td th:if="${hd.trangthai == 6}">Đã hủy</td>
                                                <td th:if="${hd.trangthai == 5 or hd.trangthai == 6}"
                                                    style="width: 100px">
                                                    <form th:action="@{/mualai(id=${hd.id})}" method="post">
                                                        <button type="submit" class="btn"
                                                                style="background-color: rgb(249,72,42);color: white">
                                                            Mua lại
                                                        </button>
                                                    </form>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <img th:if="${#lists.isEmpty(lstHoaDon)}" src="../dist/img/no_product.png" style="margin-left: 28%" alt="">
                                        <!--                                        <div class="d-flex flex-row-reverse">-->
                                        <!--                                            <nav aria-label="Page navigation example"-->
                                        <!--                                                 th:if="${lstHoaDon.totalPages>1}">-->
                                        <!--                                                <ul class="pagination">-->
                                        <!--                                                    <li class="page-item" th:if="${lstHoaDon.number>0}"><a-->
                                        <!--                                                            class="page-link phantrang"-->
                                        <!--                                                            th:href="@{'?page='+${lstHoaDon.number-1}}">Trước</a>-->
                                        <!--                                                    </li>-->
                                        <!--                                                    <li class="page-item"-->
                                        <!--                                                        th:each="i:${#numbers.sequence(1,lstHoaDon.totalPages)}"-->
                                        <!--                                                        th:classappend="${pageNo==i-1?'active':''}"><a-->
                                        <!--                                                            class="page-link phantrang" th:href="@{'?page='+${i-1}}"-->
                                        <!--                                                            th:text="${i}"></a></li>-->
                                        <!--                                                    <li class="page-item"-->
                                        <!--                                                        th:if="${lstHoaDon.number<lstHoaDon.totalPages-1}"><a-->
                                        <!--                                                            class="page-link phantrang"-->
                                        <!--                                                            th:href="@{'?page='+${lstHoaDon.number+1}}">Sau</a>-->
                                        <!--                                                    </li>-->
                                        <!--                                                </ul>-->
                                        <!--                                            </nav>-->
                                        <!--                                        </div>-->
                                    </div>
                                    <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel"
                                         aria-labelledby="profile-tab" tabindex="0">
                                        <table class="table table-bordered table-hover text-center">
                                            <thead class="table table-danger">
                                            <tr>
                                                <th>STT</th>
                                                <th>Mã hóa đơn</th>
                                                <th>Tên khách hàng</th>
                                                <th>Số điện thoại</th>
                                                <th>Tổng tiền</th>
                                                <th style="white-space: nowrap;">Ngày giao dự kiến</th>
                                                <th>Trạng thái</th>
                                                <th>Thao tác</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="hd,stt:${lstHoaDon0}">
                                                <td th:text="${stt.index+1}"></td>
                                                <td th:text="${hd.mahoadon}"></td>
                                                <td th:text="${hd.khachhang.nguoidung.hovaten}"></td>
                                                <td th:text="${hd.sdt}"></td>
                                                <td th:text="${#numbers.formatDecimal(hd.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></td>
                                                <td th:text="${#dates.format(hd.ngaygiaodukien, 'dd/MM/yyyy')}"></td>
                                                <td th:if="${hd.trangthai == 0}">Chờ xác nhận</td>
                                                <td th:if="${hd.trangthai == 1}">Đã xác nhận</td>
                                                <td th:if="${hd.trangthai == 2}">Chờ giao hàng</td>
                                                <td th:if="${hd.trangthai == 3}">Đang giao hàng</td>
                                                <td th:if="${hd.trangthai == 4}">Đã thanh toán</td>
                                                <td th:if="${hd.trangthai == 5}">Đã hoàn thành</td>
                                                <td th:if="${hd.trangthai == 6}">Đã hủy</td>
                                                <td th:if="${hd.trangthai == 5 or hd.trangthai == 6}"
                                                    style="width: 100px">
                                                    <a class="btn"
                                                       style="background-color: rgb(249,72,42);color: white">
                                                        Mua lại
                                                    </a>
                                                </td>
                                                <td style="width: 100px">
                                                    <a class="btn" data-bs-toggle="modal"
                                                       data-bs-target="#staticBackdrop"
                                                       style="background-color: rgb(249,72,42);color: white">
                                                        Huỷ đơn hàng
                                                    </a>
                                                    <!-- Modal -->
                                                    <div class="modal fade" id="staticBackdrop"
                                                         data-bs-backdrop="static" data-bs-keyboard="false"
                                                         tabindex="-1" aria-labelledby="staticBackdropLabel"
                                                         aria-hidden="true">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h1 class="modal-title fs-5"
                                                                        id="staticBackdropLabel">Hủy đơn hàng</h1>
                                                                    <button type="button" class="btn-close"
                                                                            data-bs-dismiss="modal"
                                                                            aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="mb-3">
                                                                        <label for="lydohuy" class="col-form-label"
                                                                               style="margin-right: 350px">Lý do hủy
                                                                            đơn:</label>
                                                                        <input type="text" id="lydohuy" name="lydohuy"
                                                                               class="form-control">
                                                                    </div>
                                                                    <span id="lydohuyError" style="color: red"></span>
                                                                </div>
                                                                <div class="modal-footer" style="height: 80px">
                                                                    <button type="button" class="btn btn-secondary"
                                                                            data-bs-dismiss="modal"
                                                                            style="margin-top: 100px; margin-left: 20px; height: 40px; width: 70px">
                                                                        Đóng
                                                                    </button>
                                                                    <button type="button" class="btn"
                                                                            th:data-id="${hd.id}"
                                                                            onclick="huyDonHang(this)" id="huydonhang"
                                                                            style="background-color: rgb(249,72,42);color: white; margin-top: 100px; margin-left: 150px; height: 40px; width: 160px">
                                                                        HỦY ĐƠN HÀNG
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <img th:if="${#lists.isEmpty(lstHoaDon0)}" src="../dist/img/no_product.png" style="margin-left: 28%" alt="">
                                    </div>

                                    <div class="tab-pane fade" id="contact-tab-pane" role="tabpanel"
                                         aria-labelledby="contact-tab" tabindex="0">
                                        <table class="table table-bordered table-hover text-center">
                                            <thead class="table table-danger">
                                            <tr>
                                                <th>STT</th>
                                                <th>Mã hóa đơn</th>
                                                <th>Tên khách hàng</th>
                                                <th>Số điện thoại</th>
                                                <th>Tổng tiền</th>
                                                <th style="white-space: nowrap;">Ngày giao dự kiến</th>
                                                <th>Trạng thái</th>
                                                <!--                                                <th>Thao tác</th>-->
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="hd,stt:${lstHoaDon1}">
                                                <td th:text="${stt.index+1}"></td>
                                                <td th:text="${hd.mahoadon}"></td>
                                                <td th:text="${hd.khachhang.nguoidung.hovaten}"></td>
                                                <td th:text="${hd.sdt}"></td>
                                                <td th:text="${#numbers.formatDecimal(hd.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></td>
                                                <td th:text="${#dates.format(hd.ngaygiaodukien, 'dd/MM/yyyy')}"></td>
                                                <td th:if="${hd.trangthai == 0}">Chờ xác nhận</td>
                                                <td th:if="${hd.trangthai == 1}">Đã xác nhận</td>
                                                <td th:if="${hd.trangthai == 2}">Chờ giao hàng</td>
                                                <td th:if="${hd.trangthai == 3}">Đang giao hàng</td>
                                                <td th:if="${hd.trangthai == 4}">Đã thanh toán</td>
                                                <td th:if="${hd.trangthai == 5}">Đã hoàn thành</td>
                                                <td th:if="${hd.trangthai == 6}">Đã hủy</td>
                                                <!--                                                <td th:if="${hd.trangthai == 5 or hd.trangthai == 6}"-->
                                                <!--                                                    style="width: 100px">-->
                                                <!--                                                    <a class="btn"-->
                                                <!--                                                       style="background-color: rgb(249,72,42);color: white">-->
                                                <!--                                                        Mua lại-->
                                                <!--                                                    </a>-->
                                                <!--                                                </td>-->
                                            </tr>
                                            </tbody>
                                        </table>
                                        <img th:if="${#lists.isEmpty(lstHoaDon1)}" src="../dist/img/no_product.png" style="margin-left: 28%" alt="">
                                    </div>
                                    <div class="tab-pane fade" id="disabled-tab-pane1"
                                         role="tabpanel"
                                         aria-labelledby="disabled-tab" tabindex="0">
                                        <table class="table table-bordered table-hover text-center">
                                            <thead class="table table-danger">
                                            <tr>
                                                <th>STT</th>
                                                <th>Mã hóa đơn</th>
                                                <th>Tên khách hàng</th>
                                                <th>Số điện thoại</th>
                                                <th>Tổng tiền</th>
                                                <th style="white-space: nowrap;">Ngày giao dự kiến</th>
                                                <th>Trạng thái</th>
                                                <!--                                                <th>Thao tác</th>-->
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="hd,stt:${lstHoaDon2}">
                                                <td th:text="${stt.index+1}"></td>
                                                <td th:text="${hd.mahoadon}"></td>
                                                <td th:text="${hd.khachhang.nguoidung.hovaten}"></td>
                                                <td th:text="${hd.sdt}"></td>
                                                <td th:text="${#numbers.formatDecimal(hd.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></td>
                                                <td th:text="${#dates.format(hd.ngaygiaodukien, 'dd/MM/yyyy')}"></td>
                                                <td th:if="${hd.trangthai == 0}">Chờ xác nhận</td>
                                                <td th:if="${hd.trangthai == 1}">Đã xác nhận</td>
                                                <td th:if="${hd.trangthai == 2}">Chờ giao hàng</td>
                                                <td th:if="${hd.trangthai == 3}">Đang giao hàng</td>
                                                <td th:if="${hd.trangthai == 4}">Đã thanh toán</td>
                                                <td th:if="${hd.trangthai == 5}">Đã hoàn thành</td>
                                                <td th:if="${hd.trangthai == 6}">Đã hủy</td>
                                                <!--                                                <td th:if="${hd.trangthai == 5 or hd.trangthai == 6}"-->
                                                <!--                                                    style="width: 100px">-->
                                                <!--                                                    <a class="btn"-->
                                                <!--                                                       style="background-color: rgb(249,72,42);color: white">-->
                                                <!--                                                        Mua lại-->
                                                <!--                                                    </a>-->
                                                <!--                                                </td>-->
                                            </tr>
                                            </tbody>
                                        </table>
                                        <img th:if="${#lists.isEmpty(lstHoaDon2)}" src="../dist/img/no_product.png" style="margin-left: 28%" alt="">
                                    </div>
                                    <div class="tab-pane fade" id="disabled-tab-pane2"
                                         role="tabpanel"
                                         aria-labelledby="disabled-tab" tabindex="0">
                                        <table class="table table-bordered table-hover text-center">
                                            <thead class="table table-danger">
                                            <tr>
                                                <th>STT</th>
                                                <th>Mã hóa đơn</th>
                                                <th>Tên khách hàng</th>
                                                <th>Số điện thoại</th>
                                                <th>Tổng tiền</th>
                                                <th style="white-space: nowrap;">Ngày giao dự kiến</th>
                                                <th>Trạng thái</th>
                                                <!--                                                <th>Thao tác</th>-->
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="hd,stt:${lstHoaDon3}">
                                                <td th:text="${stt.index+1}"></td>
                                                <td th:text="${hd.mahoadon}"></td>
                                                <td th:text="${hd.khachhang.nguoidung.hovaten}"></td>
                                                <td th:text="${hd.sdt}"></td>
                                                <td th:text="${#numbers.formatDecimal(hd.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></td>
                                                <td th:text="${#dates.format(hd.ngaygiaodukien, 'dd/MM/yyyy')}"></td>
                                                <td th:if="${hd.trangthai == 0}">Chờ xác nhận</td>
                                                <td th:if="${hd.trangthai == 1}">Đã xác nhận</td>
                                                <td th:if="${hd.trangthai == 2}">Chờ giao hàng</td>
                                                <td th:if="${hd.trangthai == 3}">Đang giao hàng</td>
                                                <td th:if="${hd.trangthai == 4}">Đã thanh toán</td>
                                                <td th:if="${hd.trangthai == 5}">Đã hoàn thành</td>
                                                <td th:if="${hd.trangthai == 6}">Đã hủy</td>
                                                <!--                                                <td th:if="${hd.trangthai == 5 or hd.trangthai == 6}"-->
                                                <!--                                                    style="width: 100px">-->
                                                <!--                                                    <a class="btn"-->
                                                <!--                                                       style="background-color: rgb(249,72,42);color: white">-->
                                                <!--                                                        Mua lại-->
                                                <!--                                                    </a>-->
                                                <!--                                                </td>-->
                                            </tr>
                                            </tbody>
                                        </table>
                                        <img th:if="${#lists.isEmpty(lstHoaDon3)}" src="../dist/img/no_product.png" style="margin-left: 28%" alt="">
                                    </div>
                                    <div class="tab-pane fade" id="disabled-tab-pane3"
                                         role="tabpanel"
                                         aria-labelledby="disabled-tab" tabindex="0">
                                        <table class="table table-bordered table-hover text-center">
                                            <thead class="table table-danger">
                                            <tr>
                                                <th>STT</th>
                                                <th>Mã hóa đơn</th>
                                                <th>Tên khách hàng</th>
                                                <th>Số điện thoại</th>
                                                <th>Tổng tiền</th>
                                                <th style="white-space: nowrap;">Ngày giao dự kiến</th>
                                                <th>Trạng thái</th>
                                                <!--                                                <th>Thao tác</th>-->
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="hd,stt:${lstHoaDon4}">
                                                <td th:text="${stt.index+1}"></td>
                                                <td th:text="${hd.mahoadon}"></td>
                                                <td th:text="${hd.khachhang.nguoidung.hovaten}"></td>
                                                <td th:text="${hd.sdt}"></td>
                                                <td th:text="${#numbers.formatDecimal(hd.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></td>
                                                <td th:text="${#dates.format(hd.ngaygiaodukien, 'dd/MM/yyyy')}"></td>
                                                <td th:if="${hd.trangthai == 0}">Chờ xác nhận</td>
                                                <td th:if="${hd.trangthai == 1}">Đã xác nhận</td>
                                                <td th:if="${hd.trangthai == 2}">Chờ giao hàng</td>
                                                <td th:if="${hd.trangthai == 3}">Đang giao hàng</td>
                                                <td th:if="${hd.trangthai == 4}">Đã thanh toán</td>
                                                <td th:if="${hd.trangthai == 5}">Đã hoàn thành</td>
                                                <td th:if="${hd.trangthai == 6}">Đã hủy</td>
                                                <!--                                                <td th:if="${hd.trangthai == 5 or hd.trangthai == 6}"-->
                                                <!--                                                    style="width: 100px">-->
                                                <!--                                                    <a class="btn"-->
                                                <!--                                                       style="background-color: rgb(249,72,42);color: white">-->
                                                <!--                                                        Mua lại-->
                                                <!--                                                    </a>-->
                                                <!--                                                </td>-->
                                            </tr>
                                            </tbody>
                                        </table>
                                        <img th:if="${#lists.isEmpty(lstHoaDon4)}" src="../dist/img/no_product.png" style="margin-left: 28%" alt="">
                                    </div>
                                    <div class="tab-pane fade" id="disabled-tab-pane4"
                                         role="tabpanel"
                                         aria-labelledby="disabled-tab" tabindex="0">
                                        <table class="table table-bordered table-hover text-center">
                                            <thead class="table table-danger">
                                            <tr>
                                                <th>STT</th>
                                                <th>Mã hóa đơn</th>
                                                <th>Tên khách hàng</th>
                                                <th>Số điện thoại</th>
                                                <th>Tổng tiền</th>
                                                <th style="white-space: nowrap;">Ngày nhận hàng</th>
                                                <th>Trạng thái</th>
                                                <th>Thao tác</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="hd,stt:${lstHoaDon5}">
                                                <td th:text="${stt.index+1}"></td>
                                                <td th:text="${hd.mahoadon}"></td>
                                                <td th:text="${hd.khachhang.nguoidung.hovaten}"></td>
                                                <td th:text="${hd.sdt}"></td>
                                                <td th:text="${#numbers.formatDecimal(hd.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></td>
                                                <td th:text="${#dates.format(hd.ngaynhanhang, 'dd/MM/yyyy')}"></td>
                                                <td th:if="${hd.trangthai == 0}">Chờ xác nhận</td>
                                                <td th:if="${hd.trangthai == 1}">Đã xác nhận</td>
                                                <td th:if="${hd.trangthai == 2}">Chờ giao hàng</td>
                                                <td th:if="${hd.trangthai == 3}">Đang giao hàng</td>
                                                <td th:if="${hd.trangthai == 4}">Đã thanh toán</td>
                                                <td th:if="${hd.trangthai == 5}">Đã hoàn thành</td>
                                                <td th:if="${hd.trangthai == 6}">Đã hủy</td>
                                                <td th:if="${hd.trangthai == 5 or hd.trangthai == 6}"
                                                    style="width: 100px">
                                                    <form th:action="@{/mualai(id=${hd.id})}" method="post">
                                                        <button type="submit" class="btn"
                                                                style="background-color: rgb(249,72,42);color: white">
                                                            Mua lại
                                                        </button>
                                                    </form>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <img th:if="${#lists.isEmpty(lstHoaDon5)}" src="../dist/img/no_product.png" style="margin-left: 28%" alt="">
                                    </div>
                                    <div class="tab-pane fade" id="disabled-tab-pane5"
                                         role="tabpanel"
                                         aria-labelledby="disabled-tab" tabindex="0">
                                        <table class="table table-bordered table-hover text-center">
                                            <thead class="table table-danger">
                                            <tr>
                                                <th>STT</th>
                                                <th>Mã hóa đơn</th>
                                                <th>Tên khách hàng</th>
                                                <th>Số điện thoại</th>
                                                <th>Tổng tiền</th>
                                                <!--                                                <th style="white-space: nowrap;">Ngày giao dự kiến</th>-->
                                                <th>Trạng thái</th>
                                                <th>Thao tác</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="hd,stt:${lstHoaDon6}">
                                                <td th:text="${stt.index+1}"></td>
                                                <td th:text="${hd.mahoadon}"></td>
                                                <td th:text="${hd.khachhang.nguoidung.hovaten}"></td>
                                                <td th:text="${hd.sdt}"></td>
                                                <td th:text="${#numbers.formatDecimal(hd.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></td>
                                                <!--                                                <td th:text="${#dates.format(hd.ngaygiaodukien, 'dd/MM/yyyy')}"></td>-->
                                                <td th:if="${hd.trangthai == 0}">Chờ xác nhận</td>
                                                <td th:if="${hd.trangthai == 1}">Đã xác nhận</td>
                                                <td th:if="${hd.trangthai == 2}">Chờ giao hàng</td>
                                                <td th:if="${hd.trangthai == 3}">Đang giao hàng</td>
                                                <td th:if="${hd.trangthai == 4}">Đã thanh toán</td>
                                                <td th:if="${hd.trangthai == 5}">Đã hoàn thành</td>
                                                <td th:if="${hd.trangthai == 6}">Đã hủy</td>
                                                <td th:if="${hd.trangthai == 5 or hd.trangthai == 6}"
                                                    style="width: 100px">
                                                    <form th:action="@{/mualai(id=${hd.id})}" method="post">
                                                        <button type="submit" class="btn"
                                                                style="background-color: rgb(249,72,42);color: white">
                                                            Mua lại
                                                        </button>
                                                    </form>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <img th:if="${#lists.isEmpty(lstHoaDon6)}" src="../dist/img/no_product.png" style="margin-left: 28%" alt="">
                                    </div>
                                    <!--                                    <div class="tab-pane fade" id="disabled-tab-pane2"-->
                                    <!--                                         role="tabpanel"-->
                                    <!--                                         aria-labelledby="disabled-tab" tabindex="0">-->
                                    <!--                                        <div>-->
                                    <!--                                            <div th:each="lstHoaDon5:${lstHoaDon5}">-->
                                    <!--                                                <div class="container">-->
                                    <!--                                                    <div class="item-card row">-->
                                    <!--                                                        <div class="col-md-2">-->
                                    <!--                                                            <img alt="Item Image"-->
                                    <!--                                                                 class="item-image img-fluid">-->
                                    <!--                                                        </div>-->
                                    <!--                                                        <div class="col-md-7">-->
                                    <!--                                                            <h5 th:text="${lstHoaDon5.sanphamchitiet.sanpham.tensanpham}"></h5>-->
                                    <!--                                                            <p>Phân loại hàng:-->
                                    <!--                                                                <span th:text="${lstHoaDon5.sanphamchitiet.mausac.ten + ', '}">Đen</span>-->
                                    <!--                                                                <span th:text="${lstHoaDon5.sanphamchitiet.kichco.ten}">Đen</span>-->
                                    <!--                                                            </p>-->
                                    <!--                                                            <p>x <span th:text="${lstHoaDon5.soluong}"></span></p>-->
                                    <!--                                                            &lt;!&ndash; <button class="btn btn-outline-success btn-sm">Trả hàng miễn phí 15 ngày</button> &ndash;&gt;-->
                                    <!--                                                        </div>-->
                                    <!--                                                        <div class="col-md-3 text-right">-->
                                    <!--                                                            <p class="font-weight-bold text-danger">Thành tiền:-->
                                    <!--                                                                <span th:text="${#numbers.formatDecimal(lstHoaDon5.hoadon.tongtien, 0, 'COMMA', 0, 'POINT')+'&#x20ab;'}"></span>-->
                                    <!--                                                            </p>-->
                                    <!--                                                            <button class="btn btn-rebuy btn-block">Mua Lại</button>-->
                                    <!--                                                        </div>-->
                                    <!--                                                    </div>-->
                                    <!--                                                </div>-->
                                    <!--                                            </div>-->
                                    <!--                                            <nav aria-label="Page navigation example"-->
                                    <!--                                                 th:if="${lstHoaDon5.totalPages>1}">-->
                                    <!--                                                <ul class="pagination">-->
                                    <!--                                                    <li class="page-item" th:if="${lstHoaDon5.number>0}"><a-->
                                    <!--                                                            class="page-link chuyentrang"-->
                                    <!--                                                            th:href="@{'?page='+${lstHoaDon5.number-1}}">Trước</a>-->
                                    <!--                                                    </li>-->
                                    <!--                                                    <li class="page-item"-->
                                    <!--                                                        th:each="i:${#numbers.sequence(1,lstHoaDon5.totalPages)}"-->
                                    <!--                                                        th:classappend="${pageNo==i-1?'active':''}"><a-->
                                    <!--                                                            class="page-link chuyentrang" th:href="@{'?page='+${i-1}}"-->
                                    <!--                                                            th:text="${i}"></a></li>-->
                                    <!--                                                    <li class="page-item"-->
                                    <!--                                                        th:if="${lstHoaDon5.number<lstHoaDon5.totalPages-1}"><a-->
                                    <!--                                                            class="page-link chuyentrang"-->
                                    <!--                                                            th:href="@{'?page='+${lstHoaDon5.number+1}}">Sau</a>-->
                                    <!--                                                    </li>-->
                                    <!--                                                </ul>-->
                                    <!--                                            </nav>-->
                                    <!--                                        </div>-->
                                    <!--                                    </div>-->
                                </div>
                            </div>
                            <!-- /.card -->
                        </div>
                        <!-- /.col -->
                    </div>
                    <!-- /.row -->
                </div>
                <!-- /.container-fluid -->
</section>
<!-- cart page content section end -->

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script th:inline="javascript">
    var lstEmailFromDb = /*[[${lstEmail}]]*/ [];
    var lstSdtFromDb = /*[[${lstSdt}]]*/ [];
    var lstCccdFromDb = /*[[${lstCccd}]]*/ [];
    var userDangnhap = /*[[${session.userDangnhap}]]*/ [];

    var opentabDiaChi = /*[[${addDiaChiSuccess}]]*/ false;
    var success = /*[[${success}]]*/ false;
    var repurchase = /*[[${repurchase}]]*/ false;

    if (success === true) {
        const Toast = Swal.mixin({
            toast: true,
            position: "top-end",
            showConfirmButton: false,
            timer: 2000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.onmouseenter = Swal.stopTimer;
                toast.onmouseleave = Swal.resumeTimer;
            }
        });

        Toast.fire({
            icon: "success",
            title: "Lưu thay đổi!"
        });
    }
    if (repurchase === false) {
        sessionStorage.setItem('activeTab', 'v-pills-messages');
        const Toast = Swal.mixin({
            toast: true,
            position: "top-end",
            showConfirmButton: false,
            timer: 2000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.onmouseenter = Swal.stopTimer;
                toast.onmouseleave = Swal.resumeTimer;
            }
        });

        Toast.fire({
            icon: "error",
            title: "Sản phẩm đã hết hàng hoặc đã ngừng kinh doanh!"
        });
    }
</script>
<script>
    if (opentabDiaChi === true) {
        document.getElementById('xemthongtindiachi').style.display = 'block';
    }
    document.getElementById("capnhatthongtintaikhoan").style.display = "none";
    document.getElementById("capnhatdiachi").style.display = "none";
    document.getElementById("capnhatdiachi2").style.display = "none";
    document.getElementById("themdiachi").style.display = "none";
    document.getElementById("btnchuyencapnhattaikhoan").addEventListener("click", function (event) {
        event.preventDefault();
        document.getElementById("xemthongtintaikhoan").style.display = "none";
        document.getElementById("capnhatthongtintaikhoan").style.display = "block";
    });

    document.getElementById("huycapnhattaikhoan").addEventListener("click", function (event) {
        event.preventDefault();
        document.getElementById("capnhatthongtintaikhoan").style.display = "none";
        document.getElementById("xemthongtintaikhoan").style.display = "block";
    });

    document.getElementById("chuyencapnhatdiachi").addEventListener("click", function (event) {
        event.preventDefault();
        document.getElementById("xemthongtindiachi").style.display = "none";
        document.getElementById("capnhatdiachi2").style.display = "none";
        document.getElementById("capnhatdiachi").style.display = "block";
    });
    document.getElementById("huycapnhatdiachi").addEventListener("click", function (event) {
        event.preventDefault();
        document.getElementById("capnhatdiachi").style.display = "none";
        document.getElementById("xemthongtindiachi").style.display = "block";
    });

    document.getElementById("chuyencapnhatdiachi2").addEventListener("click", function (event) {
        event.preventDefault();
        document.getElementById("xemthongtindiachi").style.display = "none";
        document.getElementById("capnhatdiachi").style.display = "none";
        document.getElementById("capnhatdiachi2").style.display = "block";
    });
    document.getElementById("huycapnhatdiachi2").addEventListener("click", function (event) {
        event.preventDefault();
        document.getElementById("capnhatdiachi2").style.display = "none";
        document.getElementById("xemthongtindiachi").style.display = "block";
    });

    document.getElementById('btnXoaDiaChi').addEventListener('click', function () {
        sessionStorage.setItem('activeTab', 'v-pills-profile');
    })
    var btnUpDateTrangThai = document.getElementsByClassName('btnUpDateTrangThai');
    Array.from(btnUpDateTrangThai).forEach(function (element) {
        element.addEventListener('click', function () {
            sessionStorage.setItem('activeTab', 'v-pills-profile');
        })
    })
    document.getElementById('btnThemDiaChi').addEventListener('click', function () {
        sessionStorage.setItem('activeTab', 'v-pills-profile');
    })
    document.getElementById('btnCapNhatDiaChi').addEventListener('click', function () {
        sessionStorage.setItem('activeTab', 'v-pills-profile');
    })
    document.getElementById('btnDoiMatKhau').addEventListener('click', function () {
        sessionStorage.setItem('activeTab', 'v-pills-disabled');
    })


    // document.getElementById("chuyenthemdiachi").addEventListener("click", function (event) {
    //     event.preventDefault();
    //     document.getElementById("themdiachi").style.display = "block";
    // });
    //
    // document.getElementById("huythemdiachi").addEventListener("click", function (event) {
    //     event.preventDefault();
    //     document.getElementById("themdiachi").style.display = "none";
    // });
</script>


<!--<script>-->
<!--    document.addEventListener("DOMContentLoaded", function () {-->
<!--        // Kiểm tra và hiển thị lại form khi load trang-->
<!--        showFormErrors("capnhatthongtintaikhoan", document.getElementById("capnhatthongtintaikhoan").classList.contains("has-errors"));-->
<!--        showFormErrors("capnhatdiachi", document.getElementById("capnhatdiachi").classList.contains("has-errors"));-->
<!--        showFormErrors("themdiachi", document.getElementById("themdiachi").classList.contains("has-errors"));-->
<!--    });-->

<!--    function showFormErrors(formId, hasErrors) {-->
<!--        if (hasErrors) {-->
<!--            // Hiển thị form có lỗi-->
<!--            document.getElementById(formId).style.display = "block";-->

<!--            // Ẩn nút 'Xem thông tin tài khoản' khi hiển thị form cập nhật thông tin tài khoản-->
<!--            if (formId === "capnhatthongtintaikhoan") {-->
<!--                document.getElementById("xemthongtintaikhoan").style.display = "none";-->
<!--            }-->
<!--            // Ẩn nút 'Thông tin địa chỉ' khi hiển thị form cập nhật địa chỉ-->
<!--            else if (formId === "capnhatdiachi") {-->
<!--                document.getElementById("thongtindiachi").style.display = "none";-->
<!--            }-->
<!--            // Không cần xử lý khi hiển thị form thêm địa chỉ-->
<!--        } else {-->
<!--            // Ẩn các form khi không có lỗi-->
<!--            document.getElementById(formId).style.display = "none";-->

<!--            // Hiển thị lại nút 'Xem thông tin tài khoản' sau khi ẩn form cập nhật thông tin tài khoản-->
<!--            if (formId === "capnhatthongtintaikhoan") {-->
<!--                document.getElementById("xemthongtintaikhoan").style.display = "block";-->
<!--            }-->
<!--            // Hiển thị lại nút 'Thông tin địa chỉ' sau khi ẩn form cập nhật địa chỉ-->
<!--            else if (formId === "capnhatdiachi") {-->
<!--                document.getElementById("thongtindiachi").style.display = "block";-->
<!--            }-->
<!--            // Không cần xử lý khi ẩn form thêm địa chỉ-->
<!--        }-->
<!--    }-->
<!--</script>-->
<script src="https://cdn.jsdelivr.net/npm/jsqr"></script>
<script>
    const specialCharPattern = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/;
    const specialCharPatternAddress = /[!@#$%^&*()_+\=\[\]{};':"\\|.<>\/?]/;
    const numberPattern = /\d/;
    const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9]+\.[a-zA-Z]{2,4}(?:\.[a-zA-Z]{2,4})?$/;
    const phoneNumberPattern = /^0[0-9]{9}$/;
    const cccdPattern = /^0[0-9]{11}$/;
    const currentDate = new Date();

    function validateNguoiDung() {
        var inputTenNd = document.getElementById("hovaten").value.trim();
        var inputEmail = document.getElementById("email").value.trim();
        var inputSdt = document.getElementById("sodienthoai").value.trim();
        var inputNgaySinh = document.getElementById('ngaysinh');
        var inputCccd = document.getElementById("cccd").value.trim();

        const today = new Date();
        const ngaySinhValue = new Date(inputNgaySinh.value);

        var tenError = document.getElementById("hovatenNdError");
        var emailError = document.getElementById("emailNdError");
        var sdtError = document.getElementById("sdtNdError");
        var ngaysinhError = document.getElementById("ngaysinhNdError");
        var cccdError = document.getElementById("cccdError");

        var isValid = true;

        tenError.innerText = "";
        emailError.innerText = "";
        sdtError.innerText = "";
        ngaysinhError.innerText = "";
        cccdError.innerText = "";

        var age = today.getFullYear() - ngaySinhValue.getFullYear();
        var monthDiff = today.getMonth() - ngaySinhValue.getMonth();
        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < ngaySinhValue.getDate())) {
            age--;
        }

        if (inputNgaySinh.value === '') {
            ngaysinhError.innerText = 'Ngày sinh không được trống';
            document.getElementById('ngaysinh').style.borderColor = 'red';
            isValid = false;
        } else if (ngaySinhValue > today) {
            ngaysinhError.innerText = 'Ngày sinh không được lớn hơn ngày hiện tại';
            document.getElementById('ngaysinh').style.borderColor = 'red';
            isValid = false;
        } else if (age <= 16) {
            ngaysinhError.innerText = 'Tuổi phải từ 16 trở lên';
            document.getElementById('ngaysinh').style.borderColor = 'red';
            isValid = false;
        } else if (age > 70) {
            ngaysinhError.innerText = 'Tuổi phải từ 70 trở xuống';
            document.getElementById('ngaysinh').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('ngaysinh').style.borderColor = '#dee2e6';
        }

        if (inputTenNd === "") {
            tenError.innerText = "Họ và tên không được trống";
            document.getElementById('hovaten').style.borderColor = 'red';
            isValid = false;
        } else if (specialCharPattern.test(inputTenNd)) {
            tenError.innerText = "Họ và tên không được chứa ký tự đặc biệt";
            document.getElementById('hovaten').style.borderColor = 'red';
            isValid = false;
        } else if (numberPattern.test(inputTenNd)) {
            tenError.innerText = "Họ và tên không được chứa số";
            document.getElementById('hovaten').style.borderColor = 'red';
            isValid = false;
        } else if (inputTenNd.length > 50) {
            tenError.innerText = 'Họ và tên không được quá 50 ký tự';
            document.getElementById('hovaten').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('hovaten').style.borderColor = '#dee2e6';
        }

        if (inputCccd === '') {
            cccdError.innerText = 'CCCD không được trống';
            document.getElementById('cccd').style.borderColor = 'red';
            isValid = false;
        } else if (!cccdPattern.test(inputCccd)) {
            cccdError.innerText = 'CCCD không hợp lệ';
            document.getElementById('cccd').style.borderColor = 'red';
            isValid = false;
        } else if (checkTrungCccdUpdate() === false) {
            cccdError.innerText = 'CCCD đã tồn tại';
            document.getElementById('cccd').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('cccd').style.borderColor = '#dee2e6';
        }

        if (inputEmail === "") {
            emailError.innerText = "Email không được trống";
            document.getElementById('email').style.borderColor = 'red';
            isValid = false;
        } else if (!emailPattern.test(inputEmail)) {
            emailError.innerText = "Email không hợp lệ";
            document.getElementById('email').style.borderColor = 'red';
            isValid = false;
        } else if (checkTrungEmailUpdate() === false) {
            emailError.innerText = 'Email đã tồn tại';
            document.getElementById('email').style.borderColor = 'red';
            isValid = false;
        } else if (inputEmail.length < 5) {
            emailError.innerText = 'Email không được ít hơn 5 ký tự';
            document.getElementById('email').style.borderColor = 'red';
            isValid = false;
        } else if (inputEmail.length > 254) {
            emailError.innerText = 'Email không được quá 254 ký tự';
            document.getElementById('email').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('email').style.borderColor = '#dee2e6';
        }

        if (inputSdt === "") {
            sdtError.innerText = "Số điện thoại không được trống";
            document.getElementById('sodienthoai').style.borderColor = 'red';
            isValid = false;
        } else if (!phoneNumberPattern.test(inputSdt)) {
            sdtError.innerText = "Số điện thoại không hợp lệ";
            document.getElementById('sodienthoai').style.borderColor = 'red';
            isValid = false;
        } else if (checkTrungSdtUpdate() === false) {
            sdtError.innerText = 'Số điện thoại đã tồn tại';
            document.getElementById('sodienthoai').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('sodienthoai').style.borderColor = '#dee2e6';
        }

        if (!isValid) {
            return false; // Ngăn chặn submit form
        }

        return true;
    }

    function validateThemDiaChi() {
        var inputHoten = document.getElementById("hotennguoinhan").value.trim();
        var inputSdt = document.getElementById("sdtnguoinhan").value.trim();
        var inputTenDuong = document.getElementById("tenduong").value.trim();
        var tinhthanhSelect = document.getElementById('city').value.trim();
        var quanhuyenSelect = document.getElementById('district').value.trim();
        var xaphuongSelect = document.getElementById('ward').value.trim();

        var tennguoinhanError = document.getElementById("hotennguoinhanError");
        var sdtError = document.getElementById("sdtnguoinhanError");
        var tenduongError = document.getElementById("tenduongError");
        var tinhthanhError = document.getElementById('tinhthanhError');
        var quanhuyenError = document.getElementById('quanError');
        var xaphuongError = document.getElementById('xaError');

        var isValid = true;

        tennguoinhanError.innerText = "";
        sdtError.innerText = "";
        tenduongError.innerText = "";

        if (inputHoten === "") {
            tennguoinhanError.innerText = "Họ và tên không được trống";
            document.getElementById('hotennguoinhan').style.borderColor = 'red';
            isValid = false;
        } else if (specialCharPattern.test(inputHoten)) {
            tennguoinhanError.innerText = "Họ và tên không được chứa ký tự đặc biệt";
            document.getElementById('hotennguoinhan').style.borderColor = 'red';
            isValid = false;
        } else if (numberPattern.test(inputHoten)) {
            tennguoinhanError.innerText = "Họ và tên không được chứa số";
            document.getElementById('hotennguoinhan').style.borderColor = 'red';
            isValid = false;
        } else if (inputHoten.length > 50) {
            tennguoinhanError.innerText = 'Họ và tên không được quá 50 ký tự';
            document.getElementById('hotennguoinhan').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('hotennguoinhan').style.borderColor = '#dee2e6';
        }

        if (inputSdt === "") {
            sdtError.innerText = "Số điện thoại không được trống";
            document.getElementById('sdtnguoinhan').style.borderColor = 'red';
            isValid = false;
        } else if (!phoneNumberPattern.test(inputSdt)) {
            sdtError.innerText = "Số điện thoại không hợp lệ";
            document.getElementById('sdtnguoinhan').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('sdtnguoinhan').style.borderColor = '#dee2e6';
        }

        if (inputTenDuong === "") {
            tenduongError.innerText = "Không được để trống tên đường";
            document.getElementById('tenduong').style.borderColor = 'red';
            isValid = false;
        } else if (inputTenDuong.length > 100) {
            tenduongError.innerText = 'Địa chỉ không được quá 100 ký tự';
            document.getElementById('tenduong').style.borderColor = 'red';
            isValid = false;
        } else if (specialCharPatternAddress.test(inputTenDuong)) {
            tenduongError.innerText = "Địa chỉ không được chứa ký tự đặc biệt";
            document.getElementById('tenduong').style.borderColor = 'red';
            isValid = false;
        } else if (inputTenDuong.length < 5) {
            tenduongError.innerText = 'Địa chỉ không được ít hon 5 ký tự';
            document.getElementById('tenduong').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('tenduong').style.borderColor = '#dee2e6';
        }

        if (tinhthanhSelect === '' || quanhuyenSelect === '' || xaphuongSelect === '') {
            tinhthanhError.innerText = 'Hãy chọn địa chỉ';
            document.getElementById('city').style.borderColor = 'red';
            document.getElementById('district').style.borderColor = 'red';
            document.getElementById('ward').style.borderColor = 'red';
            isValid = false;
        } else {
            tinhthanhError.innerText = '';
            document.getElementById('city').style.borderColor = '#dee2e6';
            document.getElementById('district').style.borderColor = '#dee2e6';
            document.getElementById('ward').style.borderColor = '#dee2e6';
        }
        sessionStorage.setItem('activeTab', 'v-pills-profile');
        return isValid;
    }

    function validateSuaDiaChi() {
        var inputHoten2 = document.getElementById("hotennguoinhan2").value.trim();
        var inputSdt2 = document.getElementById("sdtnguoinhan2").value.trim();
        var inputTenDuong2 = document.getElementById("tenduong2").value.trim();
        var tennguoinhanError2 = document.getElementById("hotennguoinhanError2");
        var sdtError2 = document.getElementById("sdtnguoinhanError2");
        var tenduongError2 = document.getElementById("tenduongError2");

        var isValid = true;

        tennguoinhanError2.innerText = "";
        sdtError2.innerText = "";
        tenduongError2.innerText = "";

        if (inputHoten2 === "") {
            tennguoinhanError2.innerText = "Họ và tên không được trống";
            document.getElementById('hotennguoinhan2').style.borderColor = 'red';
            isValid = false;
        } else if (specialCharPattern.test(inputHoten2)) {
            tennguoinhanError2.innerText = "Họ và tên không được chứa ký tự đặc biệt";
            document.getElementById('hotennguoinhan2').style.borderColor = 'red';
            isValid = false;
        } else if (numberPattern.test(inputHoten2)) {
            tennguoinhanError2.innerText = "Họ và tên không được chứa số";
            document.getElementById('hotennguoinhan2').style.borderColor = 'red';
            isValid = false;
        } else if (inputHoten2.length > 50) {
            tennguoinhanError2.innerText = 'Họ và tên không được quá 50 ký tự';
            document.getElementById('hotennguoinhan2').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('hotennguoinhan2').style.borderColor = '#dee2e6';
        }

        if (inputTenDuong2 === "") {
            tenduongError2.innerText = "Không được để trống tên đường";
            document.getElementById('tenduong2').style.borderColor = 'red';
            isValid = false;
        } else if (inputTenDuong2.length > 100) {
            tenduongError2.innerText = 'Địa chỉ không được quá 100 ký tự';
            document.getElementById('tenduong2').style.borderColor = 'red';
            isValid = false;
        } else if (specialCharPatternAddress.test(inputTenDuong2)) {
            tenduongError2.innerText = "Địa chỉ không được chứa ký tự đặc biệt";
            document.getElementById('tenduong2').style.borderColor = 'red';
            isValid = false;
        } else if (inputTenDuong2.length < 5) {
            tenduongError2.innerText = 'Địa chỉ không được ít hơn 5 ký tự';
            document.getElementById('tenduong2').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('tenduong2').style.borderColor = '#dee2e6';
        }

        if (inputSdt2 === "") {
            sdtError2.innerText = "Số điện thoại không được trống";
            document.getElementById('sdtnguoinhan2').style.borderColor = 'red';
            isValid = false;
        } else if (!phoneNumberPattern.test(inputSdt2)) {
            sdtError2.innerText = "Số điện thoại không hợp lệ";
            document.getElementById('sdtnguoinhan2').style.borderColor = 'red';
            isValid = false;
        } else {
            document.getElementById('sdtnguoinhan2').style.borderColor = '#dee2e6';
        }
        sessionStorage.setItem('activeTab', 'v-pills-profile');
        return isValid;
    }

    function validateDoiMatKhau() {
        var inputMatKhau = document.getElementById("matkhau").value.trim();
        var inputMatKhauMoi = document.getElementById("matkhaumoi").value.trim();
        var inputMatKhauXn = document.getElementById("xacnhanmatkhau").value.trim();

        var matkhauError = document.getElementById("matkhauError");
        var maukhaucu = document.getElementById("maukhaucuError");
        var xacnhanmkError = document.getElementById("xacnhanmkError");

        var isValid = true;

        matkhauError.innerText = "";
        maukhaucu.innerText = "";
        xacnhanmkError.innerText = "";

        if (inputMatKhau === "") {
            matkhauError.innerText = "Không được để trống mật khẩu";
            isValid = false;
        }
        if (inputMatKhauMoi === "") {
            inputMatKhauMoi.innerText = "Không được để trống mật khẩu mới";
            isValid = false;
        }
        if (inputMatKhauXn === "") {
            xacnhanmkError.innerText = "Không được để trống xác nhận mật khẩu";
            isValid = false;
        }
        sessionStorage.setItem('activeTab', 'v-pills-disabled');
        return isValid;
    }

    function doimatkhau() {
        sessionStorage.setItem('activeTab', 'v-pills-disabled');
        return true;
    }

    function checkTrungCccd() {
        var cccdInput = document.getElementById('cccd').value;
        var isVaLid = true;
        for (var i = 0; i < lstCccdFromDb.length; i++) {
            if (cccdInput === lstCccdFromDb[i]) {
                isVaLid = false;
                break;
            }
        }

        return isVaLid;
    }

    var originalCccd = document.getElementById('cccd').value.trim();

    function checkTrungCccdUpdate() {
        var cccdInput = document.getElementById('cccd').value.trim();
        var lstCccdFromDbCopy = lstCccdFromDb.slice();
        var index = lstCccdFromDb.indexOf(originalCccd);
        if (index !== -1) {
            lstCccdFromDbCopy.splice(index, 1);
        }
        var isValid = true;
        for (var i = 0; i < lstCccdFromDbCopy.length; i++) {
            if (cccdInput === lstCccdFromDbCopy[i]) {
                isValid = false;
                break;
            }
        }
        return isValid;
    }

    function checkTrungEmail() {
        var emailInput = document.getElementById('email').value;
        var isVaLid = true;
        for (var i = 0; i < lstEmailFromDb.length; i++) {
            if (emailInput.toLowerCase() === lstEmailFromDb[i]) {
                isVaLid = false;
                break;
            }
        }
        return isVaLid;
    }

    var originalEmail = document.getElementById('email').value.trim();

    function checkTrungEmailUpdate() {
        var emailInput = document.getElementById('email').value.trim();
        var lstEmailFromDbCopy = lstEmailFromDb.slice();
        var index = lstEmailFromDb.indexOf(originalEmail);
        if (index !== -1) {
            lstEmailFromDbCopy.splice(index, 1);
        }
        var isValid = true;
        for (var i = 0; i < lstEmailFromDbCopy.length; i++) {
            if (emailInput.toLowerCase() === lstEmailFromDbCopy[i]) {
                isValid = false;
                break;
            }
        }
        return isValid;
    }

    function checkTrungSdt() {
        var sdtInput = document.getElementById('sodienthoai').value;
        var isVaLid = true;
        for (var i = 0; i < lstSdtFromDb.length; i++) {
            if (sdtInput === lstSdtFromDb[i]) {
                isVaLid = false;
                break;
            }
        }
        return isVaLid;
    }

    var originalSdt = document.getElementById('sodienthoai').value.trim();

    function checkTrungSdtUpdate() {
        var sdtInput = document.getElementById('sodienthoai').value.trim();
        var lstSdtFromDbCopy = lstSdtFromDb.slice();
        var index = lstSdtFromDb.indexOf(originalSdt);
        if (index !== -1) {
            lstSdtFromDbCopy.splice(index, 1);
        }
        var isValid = true;
        for (var i = 0; i < lstSdtFromDbCopy.length; i++) {
            if (sdtInput === lstSdtFromDbCopy[i]) {
                isValid = false;
                break;
            }
        }
        return isValid;
    }


    document.addEventListener('DOMContentLoaded', function () {
        var activeTab = sessionStorage.getItem('activeTab');

        if (activeTab) {
            var tabButton = document.getElementById(activeTab + '-tab');
            var tabPane = document.getElementById(activeTab);

            document.querySelectorAll('.nav-link').forEach(function (tab) {
                tab.classList.remove('active');
            });
            tabButton.classList.add('active');

            // Chuyển đổi trạng thái của các tab pane
            document.querySelectorAll('.tab-pane').forEach(function (pane) {
                pane.classList.remove('show', 'active');
            });
            tabPane.classList.add('show', 'active');

            // Xóa trạng thái tab khỏi sessionStorage
            sessionStorage.removeItem('activeTab');
        }

        if (sessionStorage.getItem('cancelOrderSuccess')) {
            // Display success notification
            const Toast = Swal.mixin({
                toast: true,
                position: "top-end",
                showConfirmButton: false,
                timer: 2000,
                timerProgressBar: true,
                didOpen: (toast) => {
                    toast.onmouseenter = Swal.stopTimer;
                    toast.onmouseleave = Swal.resumeTimer;
                }
            });

            Toast.fire({
                icon: "success",
                title: "Hủy đơn hàng thành công!"
            });
            // Remove the flag
            sessionStorage.removeItem('cancelOrderSuccess');


        }
    });


    function huyDonHang(element) {
        const lydohuyInput = document.getElementById('lydohuy');
        const lydohuyError = document.getElementById('lydohuyError');
        const lydohuy = lydohuyInput.value.trim();
        const id = element.getAttribute('data-id');
        // Reset error message
        lydohuyError.textContent = '';

        // Validate input
        if (lydohuy === '') {
            lydohuyError.textContent = 'Vui lòng nhập lý do hủy đơn hàng.';
            document.getElementById('lydohuyInput').style.borderColor = 'red';
            return false;
        }

        // Nếu input hợp lệ, gửi yêu cầu hủy đơn hàng
        fetch(`/api/huydonhang/${id}?lydohuy=${encodeURIComponent(lydohuy)}`, {
            method: 'GET'
        }).then(response => {
            if (response.ok) {
                return response.text();
            } else {
                throw new Error('Có lỗi xảy ra khi hủy đơn hàng.');
            }
        }).then(data => {
            // Ẩn modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('staticBackdrop'));
            modal.hide();
            sessionStorage.setItem('activeTab', 'v-pills-messages')
            sessionStorage.setItem('cancelOrderSuccess', 'true');
            window.location.reload();

        }).catch(error => {
            lydohuyError.textContent = error.message;
        });

        return true;
    }
</script>


<!--dia chi-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
<script>
    var citis = document.getElementById("city");
    var districts = document.getElementById("district");
    var wards = document.getElementById("ward");
    var Parameter = {
        url: "https://raw.githubusercontent.com/kenzouno1/DiaGioiHanhChinhVN/master/data.json",
        method: "GET",
        responseType: "application/json",
    };
    var promise = axios(Parameter);
    promise.then(function (result) {
        renderCity(result.data);
    });

    function renderCity(data) {
        for (const x of data) {
            var opt = document.createElement('option');
            opt.value = x.Name;
            opt.text = x.Name;
            opt.setAttribute('data-id', x.Id);
            citis.options.add(opt);
        }
        citis.onchange = function () {
            districts.length = 1;
            wards.length = 1;
            if (this.options[this.selectedIndex].dataset.id != "") {
                const result = data.filter(n => n.Id === this.options[this.selectedIndex].dataset.id);

                for (const k of result[0].Districts) {
                    var opt = document.createElement('option');
                    opt.value = k.Name;
                    opt.text = k.Name;
                    opt.setAttribute('data-id', k.Id);
                    districts.options.add(opt);
                }
            }
        };
        districts.onchange = function () {
            wards.length = 1;
            const dataCity = data.filter((n) => n.Id === citis.options[citis.selectedIndex].dataset.id);
            if (this.options[this.selectedIndex].dataset.id != "") {
                const dataWards = dataCity[0].Districts.filter(n => n.Id === this.options[this.selectedIndex].dataset.id)[0].Wards;

                for (const w of dataWards) {
                    var opt = document.createElement('option');
                    opt.value = w.Name;
                    opt.text = w.Name;
                    opt.setAttribute('data-id', w.Id);
                    wards.options.add(opt);
                }
            }
        };
    }

    var citis2 = document.getElementById("city2");
    var districts2 = document.getElementById("district2");
    var wards2 = document.getElementById("ward2");
    var Parameter = {
        url: "https://raw.githubusercontent.com/kenzouno1/DiaGioiHanhChinhVN/master/data.json",
        method: "GET",
        responseType: "application/json",
    };
    var promise = axios(Parameter);
    promise.then(function (result) {
        renderCity2(result.data);
    });

    function renderCity2(data) {
        for (const x2 of data) {
            var opt = document.createElement('option');
            opt.value = x2.Name;
            opt.text = x2.Name;
            opt.setAttribute('data-id', x2.Id);
            citis2.options.add(opt);
        }
        citis2.onchange = function () {
            districts2.length = 1;
            wards2.length = 1;
            if (this.options[this.selectedIndex].dataset.id != "") {
                const result = data.filter(n => n.Id === this.options[this.selectedIndex].dataset.id);

                for (const k2 of result[0].Districts) {
                    var opt = document.createElement('option');
                    opt.value = k2.Name;
                    opt.text = k2.Name;
                    opt.setAttribute('data-id', k2.Id);
                    districts2.options.add(opt);
                }
            }
        };
        districts2.onchange = function () {
            wards2.length = 1;
            const dataCity = data.filter((n) => n.Id === citis2.options[citis2.selectedIndex].dataset.id);
            if (this.options[this.selectedIndex].dataset.id != "") {
                const dataWards = dataCity[0].Districts.filter(n => n.Id === this.options[this.selectedIndex].dataset.id)[0].Wards;

                for (const w2 of dataWards) {
                    var opt = document.createElement('option');
                    opt.value = w2.Name;
                    opt.text = w2.Name;
                    opt.setAttribute('data-id', w2.Id);
                    wards2.options.add(opt);
                }
            }
        };
    }

</script>

<script>
    document.getElementById('fileInput').addEventListener('change', function(event) {
        const file = event.target.files[0];

        if (file) {
            const allowedTypes = ['image/jpeg', 'image/png', 'image/gif']; // Các loại ảnh được phép
            if (!allowedTypes.includes(file.type)) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: "top-end",
                    showConfirmButton: false,
                    timer: 2000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.onmouseenter = Swal.stopTimer;
                        toast.onmouseleave = Swal.resumeTimer;
                    }
                });

                Toast.fire({
                    icon: "error",
                    title: 'Chỉ cho phép chọn các file ảnh (JPEG, PNG, GIF).',
                });
                // Xóa tệp đã chọn
                event.target.value = '';
                return;
            }

            // Kiểm tra kích thước tệp (1 MB = 1 * 1024 * 1024 bytes)
            const maxSize = 1 * 1024 * 1024; // 1 MB

            if (file.size > maxSize) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: "top-end",
                    showConfirmButton: false,
                    timer: 2000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.onmouseenter = Swal.stopTimer;
                        toast.onmouseleave = Swal.resumeTimer;
                    }
                });

                Toast.fire({
                    icon: "error",
                    title: 'Lỗi',
                    text: "Tệp ảnh phải nhỏ hơn 1 MB."
                });
                // Xóa tệp đã chọn
                event.target.value = '';
                return;
            }

            // Nếu kích thước hợp lệ và loại tệp là ảnh, hiển thị ảnh đã chọn
            const reader = new FileReader();
            reader.onload = function(e) {
                const uploadedImage = document.getElementById('uploadedImage');
                uploadedImage.src = e.target.result;
                uploadedImage.style.display = 'block'; // Hiển thị ảnh
            };
            reader.readAsDataURL(file);

            // Gửi yêu cầu AJAX để tải lên ảnh
            const formData = new FormData();
            formData.append('anh', file);

            fetch('/api/upload', {
                method: 'POST',
                body: formData,
                credentials: 'include' // Để gửi session cookie
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Lỗi khi tải lên ảnh');
                    }
                    return response.text();
                })
                .then(data => {
                    console.log(data);
                    const Toast = Swal.mixin({
                        toast: true,
                        position: "top-end",
                        showConfirmButton: false,
                        timer: 2000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.onmouseenter = Swal.stopTimer;
                            toast.onmouseleave = Swal.resumeTimer;
                        }
                    });

                    Toast.fire({
                        icon: "success",
                        title: 'Thành công',
                        text: 'Ảnh đã được tải lên thành công!',
                    });
                })
                .catch((error) => {
                    console.error('Error:', error);
                    const Toast = Swal.mixin({
                        toast: true,
                        position: "top-end",
                        showConfirmButton: false,
                        timer: 2000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.onmouseenter = Swal.stopTimer;
                            toast.onmouseleave = Swal.resumeTimer;
                        }
                    });

                    Toast.fire({
                        icon: 'error',
                        title: 'Lỗi',
                        text: 'Đã xảy ra lỗi khi tải lên ảnh.',
                    });
                });
        }
    });

    document.getElementById('uploadedImage').addEventListener('click', function() {
        document.getElementById('fileInput').click();
    });

</script>

<!-- footer section start -->
<nav th:replace="~{/layout/footer.html}"></nav>
<!-- footer section end -->

</body>
</html>

